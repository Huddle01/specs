---
title: Orchestrator RPC
description: RPC calls for Orchestrator
---

import { Callout } from 'fumadocs-ui/components/callout';

Orchestrator uses these set of RPC Calls which can be used to communicate with any Media Node.

## createRoom

Creates a New Room on the Media Node, Room is a logical grouping of media streams, where multiple clients can connect and share media streams.

```proto
message CreateRoomRequest {
    string roomId = 1;
}

message CreateRoomResponse {
   string roomId = 1;
}
```

## joinRoom

After creating a room, clients can join the room using this RPC call.
Joining a room means that the client is ready to send and receive media streams.

<Callout>
This RPC call is used to join a room, and it also returns the RTP Capabilities of the client.
Which must be passed onto the user agent to successfully join the room.
</Callout>

```proto
message JoinRoomRequest {
   string roomId = 1;
   string peerId = 2;
 }

message JoinRoomResponse {
   string roomId = 1;
   string peerId = 2;
   ProtoRtpCapabilities rtpCapabilities = 4;
}
```

For more information on RTP Capabilities, refer to the [Media Node RTC Specs](/specs/rtc).

## createTransportOnServer

Transport is a WebRTC connection between the client and the Media Node. Every Client requires to make a Transport to send and receive media streams.
After creating a Transport on the Media Node, the client must use the SDP Info to create a Transport on the Client as well.

```proto
message CreateTransportRequest {
   string roomId = 1;
   string peerId = 2;
   string transportType = 3;
   ProtoSctpCapabilities sctpCapabilities = 4;
}

message CreateTransportResponse {
   string peerId = 1;
   ProtoTransportSDPInfo transportSDPInfo = 4;
}
```

For more information on SDP Info and SctpCapabilities, refer to the [Media Node RTC Specs](/specs/rtc).

## connectTransportOnServer

When the client has created a Transport on the client-side, it must connect the Transport to the Media Node using this RPC call.

Connecting the Transport means that the client is ready to send and receive media streams and both the media node and 
the client have successfully exchanged ICE Candidates and have made a WebRTC Connection.

```proto
message ConnectTransportRequest {
   string peerId = 1;
   string roomId = 2;
   string transportType = 3;
   ProtoDtlsParameters dtlsParameters = 4;
}

message ConnectTransportResponse {
   string peerId = 1;
   string transportId = 2;
}
```

For more information on DTLS Prameters, refer to the [Media Node RTC Specs](/specs/rtc).


## produce

Produces Media Stream ( Audio/Video ) onto the Media Node which can then be consumed by other clients connected to the same room.

<Callout >
   For more information what is produce and consume, refer to the [Media Node Terminology](/specs/terminology).
</Callout>

```proto
message ProduceRequest {
   string peerId = 1;
   string roomId = 2;
   string kind = 3;
   bool paused = 4;
   string label = 5;
   ProtoRtpParameters rtpParameters = 6;
}

message ProduceResponse {
   string peerId = 1;
   string producerId = 2;
   string label = 3;
}
```

For more information on RTP Prameters, refer to the [Media Node RTC Specs](/specs/rtc).

## consume

Consumes media stream ( Audio/Video ) from the Media Node which is produced by other clients connected to the same room.

<Callout >
   For more information what is produce and consume, refer to the [Media Node Terminology](/specs/terminology).
</Callout>

```proto
message ConsumeRequest {
   string peerId = 1;
   string roomId = 2;
   string producerPeerId = 3;
   string producerId = 4;
   string momoId = 5;
   string label = 6;
}

message ConsumeResponse {
   string peerId = 1;
   string label = 2;
   string consumerId = 3;
   string producerId = 4;
   string producerPeerId = 5;
   string kind = 6;
   ProtoRtpParameters rtpParameters = 7;
}
```

## closeProducer

Closes a producer on the Media Node which cleans up the resources used by the producer.

<Callout>
   Whenever the client is done producing media streams, it must close the producer to free up resources.
</Callout>

```proto
message CloseProducerRequest {
   string peerId = 1;
   string roomId = 2;
   string producerId = 3;
   string momoId = 4;
   string kind = 5;
}

message CloseProducerResponse {
   string peerId = 1;
}
```

## closeConsumer

Closes a consumer on the Media Node which cleans up the resources used by the consumer.

<Callout>
   Whenever the client is done consuming media streams, it must close the consumer to free up resources.
   when a producer is closed, all the consumers associated with that producer are also closed automatically.
</Callout>

```proto
message CloseConsumerRequest {
   string peerId = 1;
   string roomId =2;
   string consumerId = 3;
}

message CloseConsumerResponse {
   string peerId = 1;
   string roomId = 2;
}
```

## pauseProducer

Pauses a producer on the Media Node which stops the producer from sending media streams to its consumers.

<Callout>
   For more information on how media stream move between producers and consumers, refer to the [Media Node Architecture](/specs/architecture).
</Callout>

```proto
message PauseProducerRequest {
   string roomId = 1;
   string peerId = 2;
   string producerId = 3;
}

message PauseProducerResponse {}
```

## resumeProducer

Resumes a producer on the Media Node which starts the producer from sending media streams to its consumers.

<Callout>
   For more information on how media stream move between producers and consumers, refer to the [Media Node Architecture](/specs/architecture).
</Callout>

```proto
message ResumeProducerRequest {
   string roomId = 1;
   string peerId = 2;
   string producerId = 3;
}

message ResumeProducerResponse {}
```

For more information on RTP Prameters, refer to the [Media Node RTC Specs](/specs/rtc).

## createPipeTransport

Creates a pipe transport for media streaming, this is used to create a direct connection between two media nodes.

<Callout>
   For more information about how to use pipeTransport, refer to the [Media Node Architecture](/specs/architecture).
</Callout>

```proto
message CreatePipeTransportRequest {
    string roomId = 1;
    string remoteIp = 2;
    string remoteMomoId = 3;
 }

message CreatePipeTransportResponse {
   string roomId = 1;
   string localMomoId = 2;
   string remoteMomoId = 3;
   string transportId = 4;
   ProtoSrtpParameters srtpParameters = 5;
   ProtoTransportTuple tuple = 6;
}
```

For more information on SRTP Prameters, refer to the [Media Node RTC Specs](/specs/rtc).

## connectPipeTransport

Connects an existing pipe transport between two media nodes using this RPC call.

<Callout>
   For more information about how to use pipeTransport, refer to the [Media Node Architecture](/specs/architecture).
</Callout>

```proto
message ConnectPipeTransportRequest {
   string roomId = 1;
   string remoteIp = 2;
   string remoteMomoId = 3;

   string transportId = 4;
   ProtoSrtpParameters srtpParameters = 5;
   ProtoTransportTuple tuple = 6;
}

message ConnectPipeTransportResponse {
   string roomId = 1;
   string remoteMomoId = 2;
   string remoteMomoIp = 3;
}
```

For more information on SRTP Prameters, refer to the [Media Node RTC Specs](/specs/rtc).

## pipeProducer

When a producer is created on one media node. It must be piped to another media node using this RPC call.

If the producer media node has a pipe transport with the remote media node, then the producer can be piped to the remote media node.

<Callout>
   For more information about how piping works, refer to the [Media Node Cascading](/specs/architecture).
</Callout>

```proto
message PipeProduceRequest {
   string roomId = 1;
   string kind = 2;
   string remoteMomoId = 3;
   string producerId = 4;
   string producerPeerId = 5;
   ProtoRtpParameters rtpParameters = 6;
   string label = 7;
}

message PipeProduceResponse {
   string roomId = 1;
   string pipeProducerId = 2;
   bool status = 3;
}
```

For more information on RTP Prameters, refer to the [Media Node RTC Specs](/specs/rtc).

## pipeConsumer

When a producer is created on one media node, its must be consumed on another media node using this RPC call.

If the producer media node is piping the media stream over the pipeTransport to the remote media node, 
then the consumer can be created on the remote media node.

<Callout>
   For more information about how piping works, refer to the [Media Node Cascading](/specs/architecture).
</Callout>

```proto
message PipeConsumeRequest {
   string roomId = 1;
   string remoteMomoId = 2;
   string producerId = 3;
   string producerPeerId = 4;
}

message PipeConsumeResponse {
   string roomId = 1;
   string producerPeerId = 2;
   ProtoRtpParameters rtpParameters = 3;
   string label = 4;
   string kind = 5;
}
```

## batchCloseProducers

Closes multiple producers on the Media Node which cleans up the resources used by the producers.

```proto
message BatchCloseProducersRequest {
   message CloseProducerRecord {
      string peerId = 1;
      repeated string producerIds = 2;
   }

   repeated CloseProducerRecord repeatedCloseProducers = 1;
   string roomId = 2;
}

message BatchCloseProducersResponse {
   string status = 1;
}
```

## batchCloseConsumers

Closes multiple consumers on the Media Node which cleans up the resources used by the consumers.

```proto
message BatchCloseConsumersRequest {
   repeated string peerIds = 1;
   string roomId = 2;
}

message BatchCloseConsumersResponse {
   string status = 1;
}
```

## restartTransportIce

Restarts the ICE connection of a transport, As WebRTC connections can break due to network issues, 
this RPC call can be used to restart the ICE connection and re-establish the WebRTC connection.

<Callout title = 'How to use these RPC Calls' >
   For more information on how to use these RPC calls, refer to the [Media Node RPC Client](/clients/medianode-rpc-client).
</Callout>

```proto
message RestartIceRequest {
    string peerId = 1;
    string roomId = 2;
    string transportId = 3;
    string transportType = 4;
 }

message RestartIceResponse {
   string peerId = 1;
   string transportType = 2;
   ProtoIceParameters iceParameters = 3;
}
```

## closePeer

Closes a peer on the Media Node which cleans up all the resources used by the peer.

<Callout>
   Whenever the client is done with the media session, it must close the peer to free up resources.
   Every producer and consumer associated with the peer are also closed automatically.
</Callout>

```proto
message ClosePeerRequest {
   string peerId = 1;
   string roomId = 2;
}

message ClosePeerResponse {
   string peerId = 1;
   string roomId = 2;
}
```

## closeRoom

Closes a room on the Media Node which cleans up all the resources used by the room.

```proto
message CloseRoomRequest {
   string roomId = 1;
}

message CloseRoomResponse {
   string roomId = 1;
}
```

<Callout title = 'How to use these RPC Calls' >
   For more information on how to use these RPC calls, refer to the [Media Node RPC Client](/clients/medianode-rpc-client).
</Callout>